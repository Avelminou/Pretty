<!DOCTYPE html>
<html lang="fr">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Pretty</title>
  <link rel="icon" href="favicon.png" type="image/png" />
  <link rel="stylesheet" href="./pretty.css">
  <link rel="stylesheet" href="./head.css">
  <link rel="stylesheet" href="./setting.css">

</head>

<body id="monBody">
  <div class="protege">
    <div class="tete">
      <!-- Bouton pour ouvrir le tiroir -->
      <button class="btn-open" onclick="openDrawer()" style="border-color: #333;">‚ò∞</button>
      <b>
        <ik>&nbsp;Pretty</ik>
        <img class="deco" src="deco.jpg" style="height: 1px;">
      </b><br>
      <button class="pr" type="submit">
        <img class="img1" src="profil.png"><br>
        <b><a href="#">Profil</a></b>
      </button>
      <button class="jkj" type="submit">
        <img class="img1" src="video.png"><br>
        <b><a href="#">Video</a></b>
      </button>
      <button class="bt2" type="submit">
        <img class="img1" src="mp.png"><br>
        <b><a href="#">Message</a></b>
      </button>
      <button class="bt3" type="submit">
        <img class="img1" src="accueil.png"><br>
        <b><a href="#">Accueil</a></b>
      </button>
    </div>



    <!-- Le tiroir -->
    <div class="drawer" id="drawer">
      <!-- Bouton pour fermer le tiroir -->
      <button class="btn-close" onclick="closeDrawer()">‚úï</button>
      <h2 style="text-decoration: underline;">Theme Change</h2>
      <button onclick="changedark()" id="btn_drk" style="width: 50px; 
        height: 50px; color: white;
         background-color: rgb(32, 32, 32); border: solid 2px rgb(255, 123, 0);
         border-radius: 10px; margin-left: 20px; cursor: pointer;">Dark</button>
      <button onclick="changelight()" id="btn_drk" style="width: 50px; 
        height: 50px; color: rgb(0, 0, 0);
         background-color: rgb(255, 255, 255); border: solid 2px rgb(255, 123, 0);
         border-radius: 10px; margin-left: 5px; cursor: pointer;">Light</button>
      <button onclick="changeblue()" id="btn_drk" style="width: 50px; 
        height: 50px; color: white;
         background-color: rgb(38, 0, 255); border: solid 2px rgb(255, 123, 0);
         border-radius: 10px; margin-left: 5px; cursor: pointer;">Blue</button>
      <button onclick="changeorange()" id="btn_drk" style="width: 50px; 
        height: 50px; color: white;
         background-color: rgb(255, 115, 0); border: solid 2px rgb(0, 68, 255);
         border-radius: 10px; margin-left: 5px; cursor: pointer;">Yellow</button>

      <button id="texte" style="width: 180px; 
         background-color: rgb(32, 32, 32); color: white; margin-left: 45px;
         margin-top: 10px; border: 0;">Dark</button>
      <button style="width: 180px; 
         background-color: rgb(255, 115, 0); color: rgb(0, 0, 0); margin-left: 10px;
         margin-top: 10px; border-radius: 7px;" onclick="dictionnaire()">Utilisateurs</button>
      <button onclick="openindwon()">Ateur</button>
      <!-- Listes des objets -->
      <ul id="liste"></ul>

    </div>



    <div class="vide"></div>

    <div class="centre">
      <div class="photos">
        <img class="pdp" src="avel.jpg" alt="Photos de profil">
        <form action="video.html">
          <button id="t1" class="main">...</button>
        </form>
        <span class="nom"><a id="t2" class="a2" href="video.html">Avel Mimilitia</a></span>
        <k id="t3"> r√©el. </k>
        <j id="temps_un">Chargement...</j>
      </div>

      <div class="reel">
        <div class="video"></div>
        <button class="play"><a class="a3" href="video.html">OO</a></button>
      </div>
      <div class="numberlike">
        <m id="like-reel_1.mp4">0</m>
        <j id="t5">‚ù§Ô∏è Likes</j>
      </div>
      <div class="vupub">
        <button class="like1" onclick="addLike('reel_1.mp4')">‚ù§Ô∏è</button>


        <input class="input_coms" type="text" id='input-reel_1.mp4' placeholder="Ajouter un commentaire...">
        <button class="coms" onclick="addComment('reel_1.mp4')">coms</button>
      </div>
      <p id="t6" style="color: white; text-decoration: underline;">Les commentaires:</p>
      üîî<ul id="comments-reel_1.mp4" style="color: white;"> </ul>
    </div>

    <!-- pub1 - pretty.jpg -->
    <div class="centre">
      <div class="photos">
        <img class="pdp" src="pdp.jpg" alt="Photos de profil">
        <form action="primg1.html">
          <button class="main">...</button>
        </form>
        <span class="nom"><a class="a2" href="primg1.html">Holiness Wish you</a></span>
        <k> photos. </k>
      </div>

      <div class="pub">
        <img class="imp" src="pretty.jpg" alt="Photos de publication">
      </div>
      <div class="numberlike">
        <m id="like-pretty.jpg">0</m>
        <j>‚ù§Ô∏è Likes</j>
      </div>
      <div class="vupub">
        <button class="like1" onclick="addLike('pretty.jpg')">‚ù§Ô∏è</button>


        <input class="input_coms" type="text" id="input-pretty.jpg" placeholder="Ajouter un commentaire...">
        <button class="coms" onclick="addComment('pretty.jpg')">coms</button>
      </div>
      <p style="color: white; text-decoration: underline;">Les commentaires:</p>
      üîî<ul id="comments-pretty.jpg" style="color: white;"> </ul>
    </div>

    <!-- pub2 - Yves.jpg -->
    <div class="centre">
      <div class="photos">
        <img class="pdp" src="yves.jpg" alt="Photos de profil">
        <form action="primg2.html">
          <button class="main">...</button>
        </form>
        <span class="nom"><a class="a2" href="primg2.html">Yves Savio Remananarivo Felton</a></span>
        <k> photos. </k>
      </div>

      <div class="pub">
        <img class="imp" src="Holiness.jpg" alt="Photos de publication">
      </div>
      <div class="numberlike">
        <m id="like-Holiness.jpg">0</m>
        <j>‚ù§Ô∏è Likes</j>
      </div>
      <div class="vupub">
        <button class="like1" onclick="addLike('Holiness.jpg')">‚ù§Ô∏è</button>

        <input class="input_coms" type="text" id="input-Holiness.jpg" placeholder="Ajouter un commentaire...">
        <button class="coms" onclick="addComment('Holiness.jpg')">coms</button><br>
      </div>
      <p style="color: white; text-decoration: underline;">Les commentaires:</p>
      üîî<ul id="comments-Holiness.jpg" style="color: white;"> </ul>
    </div>

    <!-- pub4 - cute.jpg -->
    <div class="centre">
      <div class="photos">
        <img class="pdp" src="avel.jpg" alt="Photos de profil">
        <form action="primg3.html">
          <button class="main">...</button>
        </form>
        <span class="nom"><a class="a2" href="primg3.html">Avel Mimilitia</a></span>
        <k> photos. </k>

      </div>

      <div class="pub">
        <img class="imp" src="aaaaa.jpg" alt="Photos de publication">
      </div>
      <div class="numberlike">
        <m id="like-cute.jpg">0</m>
        <j>‚ù§Ô∏è Likes</j>
      </div>
      <div class="vupub">
        <button class="like1" onclick="addLike('cute.jpg')">‚ù§Ô∏è</button>

        <input class="input_coms" type="text" id="input-cute.jpg" placeholder="Ajouter un commentaire...">
        <button class="coms" onclick="addComment('cute.jpg')">Coms</button>
      </div>
      <p onclick="chowcoms()" style="color: white; 
      text-decoration: underline;">Les commentaires:</p>
      üîî<ul id="comments-cute.jpg" style="color: white;"> </ul>

    </div>
  </div>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
    import { getFirestore, doc, getDoc, setDoc, updateDoc, arrayUnion } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyC7fvrEaET7j15TtmOy-9sNHHqjEx738_w",
      authDomain: "bdavel-ca1eb.firebaseapp.com",
      projectId: "bdavel-ca1eb",
      storageBucket: "bdavel-ca1eb.firebasestorage.app",
      messagingSenderId: "6657641572",
      appId: "1:6657641572:web:00b8bbdecee9db98f86371",
      measurementId: "G-9FHVW90D82"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    const images = ["pretty.jpg", "Holiness.jpg", "cute.jpg", "reel_1.mp4"];

    images.forEach(async (id) => {
      const ref = doc(db, "images", id);
      const snap = await getDoc(ref);
      if (!snap.exists()) {
        await setDoc(ref, { likes: 0, comments: [] });
      }
      updateDisplay(id);
    });

    window.addLike = async function (imageId) {
      const ref = doc(db, "images", imageId);
      const snap = await getDoc(ref);
      const current = snap.data().likes || 0;
      await updateDoc(ref, { likes: current + 1 });
      updateDisplay(imageId);
    }

    function timeAgo(date) {
      const seconds = Math.floor((Date.now() - date.getTime()) / 1000);
      if (seconds < 60) return `${seconds} sec`;
      const minutes = Math.floor(seconds / 60);
      if (minutes < 60) return `${minutes} min`;
      const hours = Math.floor(minutes / 60);
      if (hours < 24) return `${hours} h`;
      const days = Math.floor(hours / 24);
      return `${days} j`;
    }

    window.addComment = async function (imageId) {
      const input = document.getElementById("input-" + imageId);
      const comment = input.value.trim();
      if (comment !== "") {
        const ref = doc(db, "images", imageId);
        await updateDoc(ref, {
          comments: arrayUnion({
            text: comment,
            timestamp: Date.now()
          })
        });
        input.value = "";
        updateDisplay(imageId);
      }
    }
    async function updateDisplay(imageId) {
      const ref = doc(db, "images", imageId);
      const snap = await getDoc(ref);
      if (snap.exists()) {

        document.getElementById("like-" + imageId).textContent = snap.data().likes;
        const list = document.getElementById("comments-" + imageId);
        list.innerHTML = "";
        (snap.data().comments || []).forEach(c => {
          const li = document.createElement("li");
          const date = new Date(c.timestamp);
          const elapsed = timeAgo(date);
          li.innerHTML = `
  <div>${c.text}<input type="checkbox"><span style="color: gray; 
    font-size: 12px;">.vue</span></div>
  <small style="color: gray; font-size: 12px;">${elapsed}</small>
`;

          list.appendChild(li);
        });
      }
    }


  </script>
  <script src="./date.js"></script>
  <script src="./setting.js"></script>
</body>

</html>
